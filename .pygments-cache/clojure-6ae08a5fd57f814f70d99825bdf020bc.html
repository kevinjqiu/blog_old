<div class="highlight"><pre><span class="p">(</span><span class="kd">defn </span><span class="nv">decode</span>
  <span class="s">&quot;Return the decoded message using the specified polybius-square&quot;</span>
  <span class="p">[</span><span class="nv">encoded</span> <span class="nv">polybius-square</span><span class="p">]</span>
  <span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">l2c</span> <span class="p">(</span><span class="nf">letter-2-code</span> <span class="nv">polybius-square</span><span class="p">)</span>
        <span class="nv">c2l</span> <span class="p">(</span><span class="nf">transposed-2-letter</span> <span class="nv">polybius-square</span><span class="p">)</span>
        <span class="nv">codes</span> <span class="p">(</span><span class="nb">apply concat </span><span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">get </span><span class="nv">l2c</span> <span class="nv">%</span> <span class="nv">%</span><span class="p">)</span> <span class="nv">encoded</span><span class="p">))</span>
        <span class="nv">len</span> <span class="p">(</span><span class="nb">count </span><span class="nv">codes</span><span class="p">)</span>
        <span class="nv">parts</span> <span class="p">(</span><span class="nf">partition</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">len</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">codes</span><span class="p">)]</span>
    <span class="p">(</span><span class="nb">apply str </span><span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">get </span><span class="nv">c2l</span> <span class="nv">%1</span> <span class="nv">%1</span><span class="p">)</span> <span class="p">(</span><span class="nb">map </span><span class="o">#</span><span class="p">(</span><span class="nb">vector </span><span class="nv">%1</span> <span class="nv">%2</span><span class="p">)</span> <span class="p">(</span><span class="nb">first </span><span class="nv">parts</span><span class="p">)</span> <span class="p">(</span><span class="nb">second </span><span class="nv">parts</span><span class="p">))))))</span>
</pre></div>