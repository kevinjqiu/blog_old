<div class="highlight"><pre><span class="k">def</span> <span class="n">isHappyNumber</span><span class="o">(</span><span class="n">n</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">limit</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">numOfTries</span><span class="k">:</span><span class="kt">Int</span><span class="o">,</span> <span class="n">alreadySeen</span><span class="k">:</span><span class="kt">Set</span><span class="o">[</span><span class="kt">Int</span><span class="o">])</span><span class="k">:</span><span class="kt">Boolean</span> <span class="o">=</span> <span class="o">{</span>
<span class="k">val</span> <span class="n">sos</span> <span class="k">=</span> <span class="o">((</span><span class="n">n</span><span class="o">.</span><span class="n">toString</span><span class="o">.</span><span class="n">toCharArray</span><span class="o">.</span><span class="n">map</span> <span class="o">{</span> <span class="n">digit</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="o">;</span> <span class="nc">Math</span><span class="o">.</span><span class="n">pow</span><span class="o">(</span><span class="n">digit</span><span class="o">,</span> <span class="mi">2</span><span class="o">)</span> <span class="o">}).</span><span class="n">foldLeft</span><span class="o">(</span><span class="mf">0.0</span><span class="o">)</span> <span class="o">{</span> <span class="k">_</span> <span class="o">+</span> <span class="k">_</span> <span class="o">}).</span><span class="n">toInt</span>
<span class="k">return</span> <span class="n">sos</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">?</span> <span class="kc">true</span> <span class="k">:</span> <span class="o">(</span><span class="kt">!alreadySeen.contains</span><span class="o">(</span><span class="kt">sos</span><span class="o">)</span> <span class="kt">&amp;amp</span><span class="o">;</span><span class="kt">&amp;amp</span><span class="o">;</span> <span class="n">numOfTries</span><span class="o">+</span><span class="mi">1</span> <span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="k">=</span> <span class="n">limit</span> <span class="o">&amp;</span><span class="n">amp</span><span class="o">;&amp;</span><span class="n">amp</span><span class="o">;</span> <span class="n">isHappyNumber</span><span class="o">(</span><span class="n">sos</span><span class="o">,</span> <span class="n">limit</span><span class="o">,</span> <span class="n">numOfTries</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span> <span class="n">alreadySeen</span><span class="o">+</span><span class="n">sos</span><span class="o">))</span>
<span class="o">}</span>
</pre></div>