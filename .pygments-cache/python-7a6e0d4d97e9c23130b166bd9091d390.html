<div class="highlight"><pre><span class="n">application</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="n">Application</span><span class="p">([</span>
    <span class="p">(</span><span class="s">r&#39;/ws&#39;</span><span class="p">,</span> <span class="n">handlers</span><span class="o">.</span><span class="n">MyWebSocketHandler</span><span class="p">),</span>
<span class="p">])</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">pika</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">io_loop</span> <span class="o">=</span> <span class="n">tornado</span><span class="o">.</span><span class="n">ioloop</span><span class="o">.</span><span class="n">IOLoop</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span>

    <span class="c"># PikaClient is our rabbitmq consumer</span>
    <span class="n">pc</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">PikaClient</span><span class="p">(</span><span class="n">io_loop</span><span class="p">)</span>
    <span class="n">application</span><span class="o">.</span><span class="n">pc</span> <span class="o">=</span> <span class="n">pc</span>
    <span class="n">application</span><span class="o">.</span><span class="n">pc</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="n">application</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">8888</span><span class="p">)</span>
    <span class="n">io_loop</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>